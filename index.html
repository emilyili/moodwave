<!DOCTYPE html>
<style>
  .g_main {
  pointer-events: all;
  }
  .title {  
    font-family: Montserrat;
    font-style: normal;
    font-weight: bold;
    font-size: 20px;
    line-height: 24px;
    fill: #FFFFFF;
  }
  .heading {
   font-family: Montserrat;
   font-style: normal;
   font-weight: bold;
   font-size: 12px;
   line-height: 15px;
   fill: #FFFFFF;
  }
  .body {
    font-family: Montserrat;
    font-style: normal;
    font-weight: normal;
    font-size: 12px;
    line-height: 15px;
    fill: #FFFFFF;
    overflow: hidden;
  }
</style>

<!-- Add a svg area, empty -->
<svg id="dataviz_area" height=700 width=1000></svg>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<script>
	const width = 1000;
	const height = 600;
//   const svg = d3.create("svg")
//     .attr("viewBox", [0, 0, width + 100, height + 100])
    
  var svg = d3.select("#dataviz_area")
  svg.append("rect")
    .attr("width", "100%")
    .attr("height", "100%")
    .attr("fill", "#34383A");

//   var dataset = dailyData.sort(function(a,b) {
//             return a.date - b.date;
//           })
  
	var dataset = [{"date":"2020-12-02T05:00:00.000Z","frequency":49,"topsongs":[{"singer":"Justin Bieber","name":"Confirmation","songFrequency":3},{"singer":"Justin Bieber","name":"That's What Love Is","songFrequency":3},{"singer":"Justin Bieber","name":"E.T.A.","songFrequency":3},{"singer":"Justin Bieber","name":"At Least for Now","songFrequency":2},{"singer":"Justin Bieber","name":"Second Emotion (feat. Travis Scott)","songFrequency":2},{"singer":"Justin Bieber","name":"All Around Me","songFrequency":2},{"singer":"Justin Bieber","name":"Habitual","songFrequency":2},{"singer":"Isaac Dunbar","name":"scorton's creek - re-imagined by filous","songFrequency":2},{"singer":"Juice WRLD","name":"Wishing Well","songFrequency":2},{"singer":"Marc E. Bassy","name":"NASCAR","songFrequency":2},{"singer":"Justin Bieber","name":"Come Around Me","songFrequency":2},{"singer":"L'Impératrice","name":"Sonate Pacifique","songFrequency":2},{"singer":"Juice WRLD","name":"Stay High","songFrequency":2},{"singer":"Justin Bieber","name":"Running Over (feat. Lil Dicky)","songFrequency":1},{"singer":"Justin Bieber","name":"Forever (feat. Post Malone & Clever)","songFrequency":1},{"singer":"Justin Bieber","name":"Available","songFrequency":1},{"singer":"Ryan Woods","name":"Bad Texter","songFrequency":1},{"singer":"Hippie Sabotage","name":"WRONG TIME","songFrequency":1},{"singer":"Gentle Bones","name":"I Wouldn't Know Any Better Than You","songFrequency":1},{"singer":"Keshi","name":"skeletons","songFrequency":1},{"singer":"H.E.R.","name":"Best Part (feat. Daniel Caesar)","songFrequency":1},{"singer":"Sabrina Claudio","name":"Belong to You (feat. 6LACK)","songFrequency":1},{"singer":"Summer Walker","name":"Stretch You Out (feat. A Boogie Wit da Hoodie)","songFrequency":1},{"singer":"Summer Walker","name":"Girls Need Love (with Drake) - Remix","songFrequency":1},{"singer":"BIGBABYGUCCI","name":"Drop Top Lexus","songFrequency":1},{"singer":"Dominic Fike","name":"Politics & Violence","songFrequency":1},{"singer":"Cigarettes After Sex","name":"Sunsetz","songFrequency":1},{"singer":"masego","name":"Tadow","songFrequency":1},{"singer":"Omar Apollo","name":"I'm Amazing","songFrequency":1},{"singer":"Sufjan Stevens","name":"Mystery of Love","songFrequency":1},{"singer":"PARTYNEXTDOOR","name":"NEVER AGAIN","songFrequency":1},{"singer":"Jakob Ogawa","name":"You Might Be Sleeping","songFrequency":1},{"singer":"BIGBABYGUCCI","name":"Mark Of The Beast","songFrequency":1}]},{"date":"2020-12-03T05:00:00.000Z","frequency":107,"topsongs":[{"singer":"Justin Bieber","name":"E.T.A.","songFrequency":6},{"singer":"Justin Bieber","name":"Forever (feat. Post Malone & Clever)","songFrequency":6},{"singer":"Justin Bieber","name":"Yummy - Summer Walker Remix","songFrequency":6},{"singer":"Justin Bieber","name":"Available","songFrequency":6},{"singer":"Justin Bieber","name":"That's What Love Is","songFrequency":6},{"singer":"Justin Bieber","name":"Confirmation","songFrequency":5},{"singer":"Justin Bieber","name":"Changes","songFrequency":5},{"singer":"Justin Bieber","name":"Intentions (feat. Quavo)","songFrequency":5},{"singer":"Justin Bieber","name":"Habitual","songFrequency":5},{"singer":"Kiana Ledé","name":"Wicked Games","songFrequency":5},{"singer":"Omar Apollo","name":"Hit Me Up","songFrequency":5},{"singer":"Isaac Dunbar","name":"scorton's creek - re-imagined by filous","songFrequency":5},{"singer":"Juice WRLD","name":"Wishing Well","songFrequency":5},{"singer":"Marc E. Bassy","name":"NASCAR","songFrequency":5},{"singer":"Justin Bieber","name":"All Around Me","songFrequency":5},{"singer":"Justin Bieber","name":"At Least for Now","songFrequency":5},{"singer":"Justin Bieber","name":"Take It Out on Me","songFrequency":5},{"singer":"Justin Bieber","name":"Running Over (feat. Lil Dicky)","songFrequency":5},{"singer":"Justin Bieber","name":"Yummy","songFrequency":5},{"singer":"Justin Bieber","name":"Second Emotion (feat. Travis Scott)","songFrequency":5},{"singer":"PARTYNEXTDOOR","name":"Break from Toronto","songFrequency":1},{"singer":"PARTYNEXTDOOR","name":"NEVER AGAIN","songFrequency":1}]},{"date":"2020-12-04T05:00:00.000Z","frequency":110,"topsongs":[{"singer":"Joyce Wrice","name":"That's On You","songFrequency":14},{"singer":"Juice WRLD","name":"Wishing Well","songFrequency":14},{"singer":"Marc E. Bassy","name":"NASCAR","songFrequency":14},{"singer":"Kiana Ledé","name":"Wicked Games","songFrequency":14},{"singer":"Justin Bieber","name":"Confirmation","songFrequency":13},{"singer":"Alextbh","name":"Stoop So Low","songFrequency":13},{"singer":"Omar Apollo","name":"Hit Me Up","songFrequency":13},{"singer":"Isaac Dunbar","name":"scorton's creek - re-imagined by filous","songFrequency":13},{"singer":"Bad Bunny","name":"DÁKITI","songFrequency":2}]},{"date":"2020-12-05T05:00:00.000Z","frequency":55,"topsongs":[{"singer":"Joyce Wrice","name":"That's On You","songFrequency":6},{"singer":"Isaac Dunbar","name":"scorton's creek - re-imagined by filous","songFrequency":6},{"singer":"Bad Bunny","name":"DÁKITI","songFrequency":6},{"singer":"Alextbh","name":"Stoop So Low","songFrequency":6},{"singer":"Gentle Bones","name":"I Wouldn't Know Any Better Than You","songFrequency":6},{"singer":"Juice WRLD","name":"Wishing Well","songFrequency":5},{"singer":"Kiana Ledé","name":"Wicked Games","songFrequency":5},{"singer":"Bad Bunny","name":"YO VISTO ASÍ","songFrequency":5},{"singer":"Marc E. Bassy","name":"NASCAR","songFrequency":5},{"singer":"Justin Bieber","name":"Confirmation","songFrequency":5}]},{"date":"2020-12-06T05:00:00.000Z","frequency":17,"topsongs":[{"singer":"Isaac Dunbar","name":"scorton's creek - re-imagined by filous","songFrequency":2},{"singer":"Justin Bieber","name":"Confirmation","songFrequency":2},{"singer":"Kiana Ledé","name":"Wicked Games","songFrequency":2},{"singer":"Juice WRLD","name":"Wishing Well","songFrequency":2},{"singer":"Justin Bieber","name":"Forever (feat. Post Malone & Clever)","songFrequency":2},{"singer":"Bad Bunny","name":"YO VISTO ASÍ","songFrequency":2},{"singer":"Joyce Wrice","name":"That's On You","songFrequency":2},{"singer":"Omar Apollo","name":"Stayback","songFrequency":2},{"singer":"Between Friends","name":"affection","songFrequency":1}]},{"date":"2020-12-07T05:00:00.000Z","frequency":31,"topsongs":[{"singer":"Clubhouse","name":"Weekend","songFrequency":2},{"singer":"Glass Animals","name":"Heat Waves","songFrequency":2},{"singer":"BabyJake","name":"Confidant","songFrequency":1},{"singer":"Richie Quake","name":"Nothing in My Head","songFrequency":1},{"singer":"SZA","name":"Hit Different","songFrequency":1},{"singer":"$NOT","name":"Moon & Stars (feat. Maggie Lindemann)","songFrequency":1},{"singer":"The 1975","name":"Paris","songFrequency":1},{"singer":"Badgirl$","name":"Click","songFrequency":1},{"singer":"Between Friends","name":"affection","songFrequency":1},{"singer":"SAINt JHN","name":"I Heard You Got Too Litt Last Night","songFrequency":1},{"singer":"Cigarettes After Sex","name":"Don't Let Me Go","songFrequency":1},{"singer":"Kevin Abstract","name":"Peach","songFrequency":1},{"singer":"Aries","name":"SANTA MONICA","songFrequency":1},{"singer":"Sufjan Stevens","name":"Mystery of Love","songFrequency":1},{"singer":"SAFARIO","name":"Pressure Love","songFrequency":1},{"singer":"Playboi Carti","name":"Long Time - Intro","songFrequency":1},{"singer":"Empire of the Sun","name":"Walking on a Dream","songFrequency":1},{"singer":"Omar Apollo","name":"Useless","songFrequency":1},{"singer":"Victoria Monét","name":"Moment","songFrequency":1},{"singer":"Sebastian Paul","name":"LUST DRUNK","songFrequency":1},{"singer":"PARTYNEXTDOOR","name":"NEVER AGAIN","songFrequency":1},{"singer":"Travis Scott","name":"SKELETONS","songFrequency":1},{"singer":"PARTYNEXTDOOR","name":"LOYAL (feat. Drake)","songFrequency":1},{"singer":"Miguel","name":"waves - Tame Impala Remix","songFrequency":1},{"singer":"Khalid","name":"Saturday Nights","songFrequency":1},{"singer":"Victoria Monét","name":"Ass Like That","songFrequency":1},{"singer":"Alina Baraz","name":"More Than Enough","songFrequency":1},{"singer":"Mac Miller","name":"Good News","songFrequency":1},{"singer":"jelani aryeh","name":"Where We Go","songFrequency":1}]}]
  var userData = [{"username":"chinaskixx","date":"2021-03-27T04:00:00.000Z","x":1,"y":1,"quadrant":5,"keywords":"Happy","reflections":""},{"username":"chinaskixx","date":"2021-03-07T05:00:00.000Z","x":-1,"y":-3,"quadrant":3,"keywords":"Tired, Unmotivated, Moody","reflections":""},{"username":"chinaskixx","date":"2021-03-06T05:00:00.000Z","x":-1,"y":-3,"quadrant":3,"keywords":"Tired, Self-concious","reflections":"I had a headache that day and was very unproductive which affected my mood"},{"username":"chinaskixx","date":"2021-03-07T05:00:00.000Z","x":-1,"y":-3,"quadrant":3,"keywords":"Tired, Unmotivated, Moody","reflections":""},{"username":"chinaskixx","date":"2021-03-06T05:00:00.000Z","x":-1,"y":-3,"quadrant":3,"keywords":"Tired, Self-concious","reflections":"I had a headache that day and was very unproductive which affected my mood"},{"username":"chinaskixx","date":"2021-03-09T05:00:00.000Z","x":-1,"y":2,"quadrant":8,"keywords":"Tense, Anxious","reflections":""},{"username":"chinaskixx","date":"2021-03-11T05:00:00.000Z","x":-1,"y":4,"quadrant":4,"keywords":"stressed, restless","reflections":""},{"username":"chinaskixx","date":"2021-03-11T05:00:00.000Z","x":-1,"y":4,"quadrant":4,"keywords":"stressed, restless","reflections":""},{"username":"chinaskixx","date":"2021-03-11T05:00:00.000Z","x":-1,"y":4,"quadrant":4,"keywords":"stressed, restless","reflections":""},{"username":"chinaskixx","date":"2021-03-10T05:00:00.000Z","x":-2,"y":4,"quadrant":4,"keywords":"nervous, tense, anxious, stressed","reflections":""},{"username":"chinaskixx","date":"2021-03-10T05:00:00.000Z","x":-2,"y":4,"quadrant":4,"keywords":"nervous, tense, anxious, stressed","reflections":""},{"username":"chinaskixx","date":"2021-03-30T04:00:00.000Z","x":-3,"y":-1,"quadrant":3,"keywords":"sad, down","reflections":""},{"username":"chinaskixx","date":"2021-03-24T04:00:00.000Z","x":-3,"y":1,"quadrant":4,"keywords":"anxious, stressed","reflections":""},{"username":"chinaskixx","date":"2021-03-24T04:00:00.000Z","x":-3,"y":1,"quadrant":4,"keywords":"anxious, stressed","reflections":""},{"username":"chinaskixx","date":"2021-03-23T04:00:00.000Z","x":0,"y":-2,"quadrant":7,"keywords":"neutral, tired, calm","reflections":""},{"username":"chinaskixx","date":"2021-03-23T04:00:00.000Z","x":0,"y":-2,"quadrant":7,"keywords":"neutral, tired, calm","reflections":""},{"username":"chinaskixx","date":"2021-03-16T04:00:00.000Z","x":1,"y":-2,"quadrant":6,"keywords":"Content, slightly tired but happy","reflections":""},{"username":"chinaskixx","date":"2021-03-16T04:00:00.000Z","x":1,"y":-2,"quadrant":6,"keywords":"Content, slightly tired but happy","reflections":""},{"username":"chinaskixx","date":"2021-03-28T04:00:00.000Z","x":null,"y":null,"quadrant":9,"keywords":"happy, alert","reflections":""},{"username":"chinaskixx","date":"2021-03-22T04:00:00.000Z","x":2,"y":-1,"quadrant":6,"keywords":"content, calm","reflections":""},{"username":"chinaskixx","date":"2021-03-15T04:00:00.000Z","x":2,"y":-1,"quadrant":6,"keywords":"Calm, Content, Happy","reflections":""},{"username":"chinaskixx","date":"2021-03-15T04:00:00.000Z","x":2,"y":-1,"quadrant":6,"keywords":"Calm, Content, Happy","reflections":""},{"username":"chinaskixx","date":"2021-03-18T04:00:00.000Z","x":2,"y":-1,"quadrant":6,"keywords":"Content, not worried, calm","reflections":""},{"username":"chinaskixx","date":"2021-03-13T05:00:00.000Z","x":2,"y":2,"quadrant":5,"keywords":"happy, excited","reflections":""},{"username":"chinaskixx","date":"2021-03-13T05:00:00.000Z","x":2,"y":2,"quadrant":5,"keywords":"happy, excited","reflections":""},{"username":"chinaskixx","date":"2021-03-26T04:00:00.000Z","x":2,"y":2,"quadrant":5,"keywords":"happy, elated)","reflections":""},{"username":"chinaskixx","date":"2021-03-14T05:00:00.000Z","x":3,"y":-1,"quadrant":2,"keywords":"Content, Relaxed, Chilled","reflections":""},{"username":"chinaskixx","date":"2021-03-14T05:00:00.000Z","x":3,"y":-1,"quadrant":2,"keywords":"Content, Relaxed, Chilled","reflections":""},{"username":"chinaskixx","date":"2021-03-31T04:00:00.000Z","x":3,"y":-1,"quadrant":2,"keywords":"content, relaxed","reflections":""},{"username":"chinaskixx","date":"2021-03-08T05:00:00.000Z","x":3,"y":-1,"quadrant":2,"keywords":"Content, at ease","reflections":""},{"username":"chinaskixx","date":"2021-03-12T05:00:00.000Z","x":3,"y":1,"quadrant":1,"keywords":"happy, not worrying","reflections":"Was very productive and felt good because of that"},{"username":"chinaskixx","date":"2021-03-17T04:00:00.000Z","x":3,"y":3,"quadrant":1,"keywords":"happy, excited","reflections":""},{"username":"chinaskixx","date":"2021-03-19T04:00:00.000Z","x":4,"y":1,"quadrant":1,"keywords":"happy, excited, grateful","reflections":""},{"username":"chinaskixx","date":"2021-03-19T04:00:00.000Z","x":4,"y":1,"quadrant":1,"keywords":"happy, excited, grateful","reflections":""},{"username":"chinaskixx","date":"2021-03-29T04:00:00.000Z","x":4,"y":3,"quadrant":1,"keywords":"happy, excited, motivated","reflections":""}]
	//circle chart
  var pie = d3.pie()
  var circ = pie([1,1,1,1])
  var arcOut = d3.arc()
    .innerRadius(25)
    .outerRadius(50)
  
  var arcIn = d3.arc()
    .innerRadius(3)
    .outerRadius(25)
  
  var colorScaleOut = ["#B459DE","#61ECDB","#3372D2","#FD3A3E"]
  var colorScaleIn = ["#E0BCF0","#B6F6EE","#B0C8ED","#FED2D2"]
  
  svg.append("circle")
    .attr("cx", 100)
    .attr("cy", 145)
    .attr("r", 3)
    .attr("fill", "white")
  
  svg.selectAll("path")
    .data(circ)
    .enter()
    .append("path")
    .attr("transform", "translate(100,145)")
    .attr("d", arcIn)
    .attr("fill", function(d) {
      return colorScaleIn[d.index];
    })
  
  svg.selectAll("path2")
    .data(circ)
    .enter()
    .append("path")
    .attr("transform", "translate(100,145)")
    .attr("d", arcOut)
    .attr("fill", function(d) {
      return colorScaleOut[d.index];
    })
  
  //legend descriptions
  var tgrp = svg.append("g") 
    tgrp.append("text")
      .attr("x", 25)
      .attr("y", 50)
      .attr("class", "title")
      .text("Mood Waves")
    tgrp.append("rect")
      .attr("x", 0)
      .attr("y", 240)
      .attr("width", 30)
      .attr("height", 30)
      .attr("fill", "#FD3A3E")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 250)
      .attr("class", "heading")
      .text("tense, nervous,")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 270)
      .attr("class", "heading")
      .text("stressed, upset")
    tgrp.append("rect")
      .attr("x", 0)
      .attr("y", 300)
      .attr("width", 30)
      .attr("height", 30)
      .attr("fill", "#B459DE")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 310)
      .attr("class", "heading")
      .text("alert, excited,")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 330)
      .attr("class", "heading")
      .text("elated, happy")
    tgrp.append("rect")
      .attr("x", 0)
      .attr("y", 360)
      .attr("width", 30)
      .attr("height", 30)
      .attr("fill", "#61ECDB")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 370)
      .attr("class", "heading")
      .text("content, serene,")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 390)
      .attr("class", "heading")
      .text("relaxed, calm")
    tgrp.append("rect")
      .attr("x", 0)
      .attr("y", 420)
      .attr("width", 30)
      .attr("height", 30)
      .attr("fill", "#3372D2")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 430)
      .attr("class", "heading")
      .text("tired, bored,")
    tgrp.append("text")
      .attr("x", 60)
      .attr("y", 450)
      .attr("class", "heading")
      .text("depressed, sad")
  
  //bar graph
  var graph = svg.append("g")
    .selectAll("rect")
//     .data(userData.sort(function(a,b) {
//             return a.date - b.date;
//           }))
    .data(userData)
    .join("rect")
    .attr("fill", function(d) {
      if(d.quadrant == 1)
        return "#B459DE";
      if(d.quadrant == 2)
        return "#61ECDB";
      if(d.quadrant == 3)
        return "#3372D2";
      if(d.quadrant == 4)
        return "#FD3A3E";
      if(d.quadrant == 5)
        return "#E0BCF0";
      if(d.quadrant == 6)
        return "#B6F6EE";
      if(d.quadrant == 7)
        return "#B0C8ED";
      if(d.quadrant == 8)
        return "#FED2D2";
      if(d.quadrant == 9)
        return "white";
    })
    .attr("x", (d, i) => x(i))
    .attr("y", d => ((y(d.frequency * 2) + height) / 5) + 100)
    .attr("height", d => (y(0) - y(d.frequency)) * 0.8)
    .attr("width", x.bandwidth() + 1)
  
    //hover capabilities
    .on("mouseover", function(d, i) {
			d3.select(this)
			.attr("opacity", "25%");
      var xpos = 0;
      var ypos = 0;
			var tgrp = svg.append("g")
        .attr("id", "tooltip")
        tgrp.append("rect")
          .attr("width", "249px")
          .attr("height", "90%")
          .attr("fill", "#34383A")
    
        //title
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 50)
          .attr("class", "title")
          .text("Mood Waves")
    
          //circle chart
          var pie = d3.pie()
          var circ = pie([1,1,1,1])
          var arcOut = d3.arc()
            .innerRadius(25)
            .outerRadius(50)

          var arcIn = d3.arc()
            .innerRadius(3)
            .outerRadius(25)

          var colorScaleOut = ["#B459DE","#61ECDB","#3372D2","#FD3A3E"]
          var colorScaleIn = ["#E0BCF0","#B6F6EE","#B0C8ED","#FED2D2"]

          tgrp.append("circle")
            .attr("cx", 100)
            .attr("cy", 145)
            .attr("r", 3)
            .attr("fill", "white")

          tgrp.selectAll("path")
            .data(circ)
            .enter()
            .append("path")
            .attr("transform", "translate(100,145)")
            .attr("d", arcIn)
            .attr("fill", function(d) {
              return colorScaleIn[d.index];
            })
          tgrp.selectAll("path2")
            .data(circ)
            .enter()
            .append("path")
            .attr("transform", "translate(100,145)")
            .attr("d", arcOut)
            .attr("fill", function(d) {
              return colorScaleOut[d.index];
            })
    
        //details
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 250)
          .attr("class", "heading")
          .text(`${d3.timeFormat('%b %d, %Y')(i.date)}`)
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 270)
          .attr("class", "body")
          .text("You listened to " + `${i.frequency}` + " songs.")
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 300)
          .attr("class", "heading")
          .text("top songs")
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 325)
          .attr("class", "heading")
          .text(function() {
            if(i.topsongs[0].name.length <= 25) {
              return `${i.topsongs[0].name}`;
            } else {
              return `${i.topsongs[0].name}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 340)
          .attr("class", "body")
          .text(function() {
            if(i.topsongs[0].singer.length <= 25) {
              return `${i.topsongs[0].singer}`;
            } else {
              return `${i.topsongs[0].singer}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 365)
          .attr("class", "heading")
          .text(function() {
            if(i.topsongs[1].name.length < 25) {
              return `${i.topsongs[1].name}`;
            } else {
              return `${i.topsongs[1].name}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 380)
          .attr("class", "body")
          .text(function() {
            if(i.topsongs[1].singer.length <= 25) {
              return `${i.topsongs[1].singer}`;
            } else {
              return `${i.topsongs[1].singer}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 405)
          .attr("class", "heading")
          .text(function() {
            if(i.topsongs[2].name.length < 25) {
              return `${i.topsongs[2].name}`;
            } else {
              return `${i.topsongs[2].name}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 420)
          .attr("class", "body")
          .text(function() {
            if(i.topsongs[2].singer.length <= 25) {
              return `${i.topsongs[2].singer}`;
            } else {
              return `${i.topsongs[2].singer}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 445)
          .attr("class", "heading")
          .text(function() {
            if(i.topsongs[3].name.length < 25) {
              return `${i.topsongs[3].name}`;
            } else {
              return `${i.topsongs[3].name}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 460)
          .attr("class", "body")
          .text(function() {
            if(i.topsongs[3].singer.length <= 25) {
              return `${i.topsongs[3].singer}`;
            } else {
              return `${i.topsongs[3].singer}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 485)
          .attr("class", "heading")
          .text(function() {
            if(i.topsongs[4].name.length < 25) {
              return `${i.topsongs[4].name}`;
            } else {
              return `${i.topsongs[4].name}`.slice(0,22) + "...";
            }})
        tgrp.append("text")
          .attr("x", 65)
          .attr("y", 500)
          .attr("class", "body")
          .text(function() {
            if(i.topsongs[4].singer.length <= 25) {
              return `${i.topsongs[4].singer}`;
            } else {
              return `${i.topsongs[4].singer}`.slice(0,22) + "...";
          }})
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 530)
          .attr("class", "heading")
          .text("mood")
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 550)
          .attr("class", "body")
          .text(function() {
             if(i.keywords == null) {
              return "____";
            } else if(i.keywords.length <= 30) {
              return `${i.keywords}`;
            } else {
              return `${i.keywords}`.slice(0,30) + "...";
            }})
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 580)
          .attr("class", "heading")
          .text("reflections")
        tgrp.append("text")
          .attr("x", 25)
          .attr("y", 600)
          .attr("class", "body")
          .text(function() {
            if(i.reflections == null) {
              return "____";
            } else {
              return `${i.reflections}`;
          }})
          .attr("dy", 0)
          .call(wrap, x.bandwidth());
			})
			.on("mouseout", function(d) {
			  d3.select(this)
			  .transition().duration(250)
			  .attr("opacity", "100%");
			  d3.select("#tooltip").remove();
			});

  //x axis formatting
  var temp = []
  var axis = svg.append("g")
    .call(xAxis)
    .selectAll(".tick text")
    .attr("fill", "white")
    .data(dataset)
    .each(function(d) {
      if (temp[d3.timeFormat('%B')(d.date)] == undefined) {
        temp[d3.timeFormat('%B')(d.date)] = 1;
        return d3.timeFormat('%B')(d.date);
      } else {
        return d3.select(this).remove();
      }
    })
</script>
